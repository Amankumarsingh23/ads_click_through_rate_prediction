# -*- coding: utf-8 -*-
"""Ads Click-Through Rate Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wwwGTffuykWrbObb0yNrkKNSyVlNsRUC
"""

import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import plotly.io as pio

data= pd.read_csv("/content/ad_10000records.csv")

data.head()

data['Clicked on Ad']=data['Clicked on Ad'].map({0:"N0",1:"YES"})

data['Clicked on Ad'].value_counts()

data["Gender"]=data["Gender"].map({"Male":1,"Female":0})

x=data.iloc[:,0:7]
x=x.drop(['Ad Topic Line','City'],axis=1)
y=data.iloc[:,9]

from sklearn.model_selection import train_test_split

xtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=0.2,random_state=4)

from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(

)
model.fit(xtrain,ytrain)

from sklearn.metrics import accuracy_score

y_pred=model.predict(xtest)

print(accuracy_score(ytest,y_pred))

print(accuracy_score(ytrain,model.predict(xtrain)))
print(accuracy_score(ytest,model.predict(xtest)))

import numpy as np

print("Ads Click Through Rate Prediction : ")
a = float(input("Daily Time Spent on Site: "))
b = float(input("Age: "))
c = float(input("Area Income: "))
d = float(input("Daily Internet Usage: "))
e = input("Gender (Male = 1, Female = 0) : ")

features = np.array([[a, b, c, d, e]])
print("Will the user click on ad = ", model.predict(features))

